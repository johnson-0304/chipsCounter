# Chips Counter 改造方案

## 项目现状

- 纯 vanilla HTML/CSS/JS，无构建工具
- localStorage 存储玩家数据
- 每个玩家卡片有 +/- 按钮、编辑下注、删除
- 3 套主题（深色/浅色/紫色），主题切换代码已注释
- 无 PWA、无动画、无操作记录

## 改造目标

保持 vanilla 技术栈，部署到 GitHub Pages。核心改进：交互反馈、语义化操作、历史记录、PWA。

---

## 方案详情

### 1. 庄家系统

**现状**：所有玩家平等，没有庄家概念。

**改造**：
- 页面顶部增加"庄家"设置区域，可输入庄家名字
- 庄家名字存 localStorage（key: `dealer`）
- 庄家不出现在玩家列表中，庄家是"对手方"
- 每个玩家卡片的按钮从 `+` / `-` 改为 `{玩家名}胜` / `{庄家名}胜`
  - 点击 `{玩家名}胜`：玩家筹码 + bet（玩家赢了庄家的钱）
  - 点击 `{庄家名}胜`：玩家筹码 - bet（庄家赢了玩家的钱）
- 筹码为正数 = 玩家赢着钱（绿色），负数 = 玩家输着钱（红色），零 = 白色

### 2. 交互反馈与动画

**现状**：点击按钮无任何视觉反馈。

**改造**：
- 按钮点击时添加 CSS `scale` + `opacity` 动画（按下缩小，松开弹回）
- 筹码数字变化时添加闪烁/跳动动画（CSS `@keyframes`）
- 按钮点击后短暂变色反馈（0.3s）
- 使用 CSS `transition` 和 `animation`，不引入 JS 动画库

### 3. 实时时钟 + 时间戳反馈

**现状**：无时间显示。

**改造**：
- 右上角显示实时时钟（`HH:MM:SS` 格式，`setInterval` 每秒更新）
- 每次点击胜负按钮时，时钟区域播放一个"脉冲"动画（放大再缩回 + 颜色闪烁）
- 时钟下方短暂显示最近一次操作的摘要（如 "大伟胜 +RM20"），2秒后淡出
- 这样用户能明确知道"刚才的点击生效了"

### 4. 历史记录

**现状**：无任何操作记录。

**改造**：
- localStorage 新增 key `history`，存储操作记录数组
- 每条记录：`{ timestamp, winner, loser, amount }`
- 页面底部增加"历史记录"折叠区域，点击展开
- 显示格式：`[14:32:05] 大伟胜 小明 RM20`
- 最多保留最近 100 条，超出自动清理旧记录
- 提供"清空历史"按钮

### 5. UI 优化

**现状**：功能性 UI，视觉较粗糙。

**改造**：
- 保留现有 3 套主题色系，修复主题切换功能（目前代码被注释了）
- 玩家卡片重新布局：
  - 顶部：玩家名 + 当前筹码（大字，带颜色）
  - 中间：下注金额显示
  - 底部：两个大按钮并排 —— `{玩家名}胜` | `{庄家名}胜`
  - 编辑/删除按钮缩小放到卡片右上角
- 用 `prompt()` 改为页面内 modal 弹窗（更友好，不打断体验）
- 整体间距、圆角、阴影微调，提升质感
- 移动端优先适配（平板/手机为主要使用场景）

### 6. PWA 支持

**改造**：
- 新增 `manifest.json`（app name、icons、theme color、display: standalone）
- 新增 `sw.js` service worker（缓存 HTML/CSS/JS/字体，离线可用）
- `index.html` 添加 manifest link 和 service worker 注册
- 生成基本的 PWA 图标（可用纯色 + 文字占位）
- 添加 `<meta name="apple-mobile-web-app-capable">` 等 iOS 兼容标签

---

## 文件变更清单

| 文件 | 操作 | 说明 |
|------|------|------|
| `index.html` | 修改 | 重构布局、添加庄家区域、时钟、历史记录区、PWA meta 标签 |
| `style.css` | 修改 | 新增动画、卡片重构样式、时钟样式、modal 样式、输赢颜色 |
| `counter.js` | 修改 | 庄家逻辑、历史记录、时钟、动画触发、modal 替代 prompt |
| `themeChanger.js` | 修改 | 修复主题切换功能 |
| `manifest.json` | 新增 | PWA 配置 |
| `sw.js` | 新增 | Service Worker |
| `icons/` | 新增 | PWA 图标（192x192, 512x512 SVG/PNG） |

## 不做的事情

- 不引入任何框架或构建工具
- 不做排行榜
- 不做数据导出/同步
- 不做多房间/多桌功能
- 不改变 localStorage 作为唯一存储的方式

## 实施顺序

1. 庄家系统 + 按钮语义化改造（核心逻辑变更）
2. UI 重构 + modal 弹窗（替代 prompt）
3. 动画与交互反馈
4. 实时时钟 + 时间戳反馈
5. 历史记录
6. 主题切换修复
7. PWA 配置
8. 移动端适配测试
